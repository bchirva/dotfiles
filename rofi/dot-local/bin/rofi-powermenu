#!/usr/bin/env sh

. "$XDG_CONFIG_HOME/shell/theme.sh"

main() {
    rofi_input() {
        printf '%s\n' "$(colored-pango-icon  "$WARNING_COLOR") Shutdown"
        printf '%s\n' "$(colored-pango-icon 󰑓 "$WARNING_COLOR") Reboot"
        printf '%s\n' "$(colored-pango-icon  ) Lock"
        printf '%s\n' "$(colored-pango-icon 󰍃 ) Logout"
    }

    variant=$(rofi_input \
        | rofi -config "$XDG_CONFIG_HOME/rofi/dmenu-single-column.rasi" \
        -markup-rows -i -dmenu -no-custom \
        -format 'i' \
        -p " System:" \
        -l 4 )

    case $variant in
        0) rofi-confirm "$(colored-pango-icon  "$WARNING_COLOR") Shutdown" \
            && systemctl poweroff ;;
        1) rofi-confirm "$(colored-pango-icon 󰑓 "$WARNING_COLOR") Reboot" \
            && systemctl reboot ;;
        2) loginctl lock-session "$XDG_SESSION_ID" ;;
        3)
            if pgrep openbox > /dev/null ; then
                openbox --exit
            fi
            if pgrep bspwm > /dev/null ; then
                bspc quit
            fi
    esac
}

main "$@"
